#!/bin/bash
#
# Runs Go.
#
set -o nounset -o errexit -o pipefail

SCRIPT_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
BASE_DIR=$(cd "$SCRIPT_DIR/.." && pwd)
GO_VERSION="1.15-buster"

mkdir -p "$BASE_DIR/.cache"

docker run \
  --rm \
  -it \
  -v "$BASE_DIR":"$BASE_DIR" \
  -v "$BASE_DIR/.cache":/.cache \
  -w "$BASE_DIR" \
  --user $(id -u):$(id -g) \
  golang:$GO_VERSION \
  go $@
